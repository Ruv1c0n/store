CREATE TABLE Catalog (
    ProductID SERIAL PRIMARY KEY,          -- Уникальный идентификатор продукта
    ProductName VARCHAR(255) NOT NULL,     -- Название продукта
    StockQuantity INT NOT NULL,            -- Количество товара на складе
    PricePerUnit NUMERIC(10, 2) NOT NULL   -- Цена за единицу товара
);


CREATE TABLE Orders (
    OrderID INT NOT NULL,                  -- Идентификатор заказа (может повторяться для разных товаров)
    ProductID INT NOT NULL,                -- Идентификатор продукта
    OrderDate TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, -- Дата и время заказа
    Status VARCHAR(50) DEFAULT 'в обработке', -- Статус заказа
    CustomerID INT,                        -- Идентификатор клиента
    Quantity INT NOT NULL,                 -- Количество товара в заказе
    PricePerUnit NUMERIC(10, 2) NOT NULL,  -- Цена за единицу товара на момент заказа
    TotalPrice NUMERIC(10, 2) GENERATED ALWAYS AS (Quantity * PricePerUnit) STORED, -- Итоговая сумма за товар
    PRIMARY KEY (OrderID, ProductID),      -- Составной PRIMARY KEY: уникальная комбинация заказа и товара
    FOREIGN KEY (ProductID) REFERENCES Catalog(ProductID) ON DELETE CASCADE -- Ссылка на каталог товаров
);
